{% macro formatAddress(address) %}
  {% set premise = '' %}
  {% set addressLine1 = '' %}
  {% set addressLine2 = '' %}
  {% set postTown = '' %}

  {% if address.premise %}
    {% set premise = capitalizeEachWord(address.premise) + ' ' %}
  {% endif %}

  {% if address.addressLine1 %} 
    {% set addressLine1 = capitalizeEachWord(address.addressLine1) + ', ' %} 
  {% endif %}

  {% if address.addressLine2 %} 
    {% set addressLine2 = capitalizeEachWord(address.addressLine2) + ', ' %} 
  {% endif %}

  {% if address.postTown %} 
    {% set postTown = capitalizeEachWord(address.postTown) + ', ' %} 
  {% endif %}

  {% set address = premise + addressLine1 + addressLine2 + postTown + address.postcode %}

  {{ address }}
{% endmacro %}

{%- macro capitalizeEachWord(str) -%}
  {%- set words = str.split(' ') -%}
  {%- set capitalizedWords = [] -%}
  {%- for word in words -%}
    {%- set subwords = word.split('-') -%}
    {%- set capitalizedSubwords = [] -%}
    {%- for subword in subwords -%}
      {%- set capitalizedSubword = subword | capitalize -%}
      {%- set capitalizedSubwords = capitalizedSubwords.concat(capitalizedSubword) -%}
    {%- endfor -%}
    {%- set capitalizedWord = capitalizedSubwords.join('-') -%}
    {%- set capitalizedWords = capitalizedWords.concat(capitalizedWord) -%}
  {%- endfor -%}
  {{- capitalizedWords.join(' ') -}}
{%- endmacro -%}

{% macro htmlInputErrorMessage(message) %}
  {% set errorMessage = "this.setCustomValidity('" + message + "')" %}

  {{ errorMessage }}
{% endmacro %}

{% macro htmlOptionErrorMessage(message, name) %}
  {% set errorMessage = "document.querySelectorAll('input[name=" + name + "]:checked').length === 0 ? this.setCustomValidity('" + message + "') : this.setCustomValidity('')" %}

  {{ errorMessage }}
{% endmacro %}
