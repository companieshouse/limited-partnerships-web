{% extends "layout.njk" %}
{% import 'includes/macros.njk' as macros %}

{% set pageTitle = i18n.checkYourAnswersPage.title %}

{% set checkYourAnswers = "check-your-answers" %}
{% set currentUrl = props.currentUrl %}
{% set fullName = (props.data.limitedPartnership.data.partnership_name | upper) + " " + (props.data.limitedPartnership.data.name_ending | upper) %}
{% set termMap = {
    "BY_AGREEMENT": i18n.termPage.byAgreement,
    "UNTIL_DISSOLUTION": i18n.termPage.untilDissolution,
    "NONE": i18n.termPage.noTerm
    } 
%}
{% set term = termMap[props.data.limitedPartnership.data.term] %}
{% set jurisdictionMap = {
  "england-wales": i18n.checkYourAnswersPage.jurisdictions.englandAndWales,
  "northern-ireland": i18n.checkYourAnswersPage.jurisdictions.northernIreland,
  "scotland": i18n.checkYourAnswersPage.jurisdictions.scotland
  } 
%}

{% set jurisdiction = jurisdictionMap[props.data.limitedPartnership.data.jurisdiction] %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds-from-desktop">
      <h1 class="govuk-heading-l">{{ i18n.checkYourAnswersPage.title }}</h1>
      <h2 class="govuk-heading-m">{{ i18n.checkYourAnswersPage.lpInfo }}</h2>
      {{ govukSummaryList({
        classes: "govuk-!-margin-bottom-9",
        rows: [
          {
            key: {
              text: i18n.checkYourAnswersPage.headingName
            },
            value: {
              text: fullName
            },
            actions: {
              items: [ 
                CREATE_CHANGE_LINK(
                  i18n.checkYourAnswersPage.change,
                  currentUrl | replace(checkYourAnswers, "name#partnership_name"),
                  partnershipNameChangeText,
                  "change-partnership-name-button"
                )
              ]
            }
          },
          {
            key: {
              text: i18n.checkYourAnswersPage.headingType
            },
            value: {
              text: i18n.types[props.data.limitedPartnership.data.partnership_type]
            },
            actions: {
              items: [ 
                CREATE_CHANGE_LINK(
                  i18n.checkYourAnswersPage.change,
                  currentUrl | replace(checkYourAnswers, "which-type"),
                  partnershipNameChangeText,
                  "change-partnership-type-button"
                )
              ]
            }
          },
          {
            key: {
              text: i18n.checkYourAnswersPage.headingEmail
            },
            value: {
              text: props.data.limitedPartnership.data.email
            },
            actions: {
              items: [ CREATE_CHANGE_LINK(
                i18n.checkYourAnswersPage.change,
                currentUrl | replace(checkYourAnswers, "email#email"),
                partnershipNameChangeText,
                "change-email-button"
              ) ]
            }
          },
          {
            key: {
              text: i18n.checkYourAnswersPage.headingJurisdiction
            },
            value: {
              text: jurisdiction
            },
            actions: {
              items: [ CREATE_CHANGE_LINK(
                i18n.checkYourAnswersPage.change,
                currentUrl | replace(checkYourAnswers, "where-is-the-jurisdiction#jurisdiction"),
                partnershipNameChangeText,
                "change-jurisdiction-button"
              ) ]
            } if props.data.limitedPartnership.data.partnership_type === "LP"
                or props.data.limitedPartnership.data.partnership_type === "PFLP"
          },
          {
            key: {
              text: i18n.checkYourAnswersPage.headingRegisteredOfficeAddress
            },
            value: {
              text: macros.formatAddress(props.data.limitedPartnership.data.registered_office_address, true)
            }
          },
          {
            key: {
              text: i18n.checkYourAnswersPage.headingPrincipalPlaceOfBusinessAddress
            },
            value: {
              text: macros.formatAddress(props.data.limitedPartnership.data.principal_place_of_business_address, true)
            }
          },         
          {
            key: {
            text: i18n.checkYourAnswersPage.headingTerm
            },
            value: {
              text: term
            },
            actions: {
              items: [ CREATE_CHANGE_LINK(
                i18n.checkYourAnswersPage.change,
                currentUrl | replace(checkYourAnswers, "term#term"),
                partnershipNameChangeText,
                "change-term-button" 
              ) ]
            } 
          } if props.data.limitedPartnership.data.partnership_type === "LP"
                or props.data.limitedPartnership.data.partnership_type === "SLP",
          {
            key: {
              text: i18n.checkYourAnswersPage.headingSic
            },
            value: {
              text: props.data.limitedPartnership.data.sic_codes
            },
            actions: {
              items: [ 
                CREATE_CHANGE_LINK(
                  i18n.checkYourAnswersPage.change,
                  currentUrl | replace(checkYourAnswers, "standard-industrial-classification-code#sic1"),
                  partnershipNameChangeText,
                  "change-sic-code-button"
                )
              ]
            }
          } if props.data.limitedPartnership.data.partnership_type === "LP"
                or props.data.limitedPartnership.data.partnership_type === "SLP"
        ]
      }) }}

      <br>
      <div class="govuk-button-group">
        <form class="form" action={{ props.currentUrl }} method="post">
          <input type="hidden" name="pageType" value={{ props.pageType }}>
          {% include "includes/csrf_token.njk" %}

          {{ govukCheckboxes({
            id: "lawfulPurposeStatementChecked", 
            name: "lawful_purpose_statement_checked",            
            fieldset: {
              legend: {
                text: i18n.checkYourAnswersPage.confirm,
                isPageHeading: false,
                classes: "govuk-visually-hidden"
              }
            },
            items: [
              {
                value: "true",
                text: i18n.checkYourAnswersPage.futureLawful,
                attributes: {
                  required: true
                }
              }
            ]
          }) }}

          {{ govukButton({
            text: i18n.checkYourAnswersPage.payment,
            attributes: {
              "id": "submit",
              "data-event-id": "check-your-answers-continue-to-payment-page-button"
            }
          }) }}        
        </form>
      </div>
    </div>
  </div>

{% endblock %}
